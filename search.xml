<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>节点编辑器(2):使用介绍，案例讲解</title>
      <link href="/graph_processor/2_use/"/>
      <url>/graph_processor/2_use/</url>
      
        <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>本章将会介绍节点编辑使用方式以及案例解析。</p><hr><p>讲解</p><h1 id="数据结构介绍"><a href="#数据结构介绍" class="headerlink" title="数据结构介绍"></a>数据结构介绍</h1><p>节点编辑器的所有数据都存在<strong>Graph</strong>中，共包含以下三种主要数据。</p><ul><li><strong>Node</strong>，只有<strong>ID</strong>和<strong>Position</strong>两条数据，</li><li><strong>Connection</strong>，包含起始节点和目标节点的<strong>ID</strong>，以及<strong>接口名称</strong>，</li><li><strong>Group</strong>，包含<strong>ID</strong>、<strong>组名</strong>和<strong>节点ID列表</strong>等数据。</li></ul><h2 id="节点的静态数据"><a href="#节点的静态数据" class="headerlink" title="节点的静态数据"></a>节点的静态数据</h2><p>节点的静态数据(默认数据)存储在<code>GraphProcessorUtil</code>中，下方的特性定义的静态数据都存储在此。</p><ul><li>Node Menu Attribute，特性决定了在编辑时节点在节点列表中的位置，并且菜单的最后一项会作为节点的默认名称。</li><li>Node Title Attribute，该特性用于替换默认标题，当然也可以通过<code>BaseNodeVM.Title</code>字段修改标题。</li><li>Node Title Color Attribute，该特性用于替换默认标题背景色，也可以通过<code>BaseeNodeVM.TitleColor</code>字段修改。</li><li>Node Tooltip Attribute，该特性用于给节点View增加悬停提示，可以通过<code>BaseNodeVM.Tooltip</code>字段修改提示文字。</li></ul><p>下面是使用方法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">NodeMenu(<span class="string">&quot;Custom/MyNode&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitle(<span class="string">&quot;我的节点&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitleColor(1f, 0, 0)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNode</span> : <span class="title">BaseNode</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="VM与M的映射关系"><a href="#VM与M的映射关系" class="headerlink" title="VM与M的映射关系"></a>VM与M的映射关系</h1><p>想要使用一个Graph对象，必须要有一个符合条件的VM对象来控制，默认的<code>BaseGraph</code>对应<code>BaseGraphVM</code>，VM基类没有其他功能，需要通过继承实现更多功能。   </p><h2 id="如何添加映射？"><a href="#如何添加映射？" class="headerlink" title="如何添加映射？"></a>如何添加映射？</h2><p>使用<code>ViewModelAttribute</code>，该特性的使用方式是挂在VM类上，作用是将VM类和Model类一一对应起来，映射数据存储在<code>ViewModelFactory</code>中，可通过<code>ViewModelFactory.GetViewModelType(modelType)</code>来获取Model类对应的VM类，<code>ViewModelFactory</code>是一个通用类，属于<code>GraphProcessor</code>依赖的一部分。</p><p>下面是一个简单的自定义节点，通过<code>ViewModel</code>特性，把VM类和Model类做了映射。如果没有对应的VM类，会自动创建默认的BaseNodeVM对象。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">NodeMenu(<span class="string">&quot;Custom/MyNode&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitle(<span class="string">&quot;我的节点&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitleColor(1f, 0, 0)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNode</span> : <span class="title">BaseNode</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">ViewModel(typeof(MyNode))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNodeVM</span> : <span class="title">BaseNodeVM</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyNodeVM</span>(<span class="params">MyNode model</span>) : <span class="title">base</span>(<span class="params">model</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>GraphProcessor基础运用所需要的特性不多，主要是M和VM的映射，本章到此结束，下期将会用节点编辑器做一个简单的计算器出来。如果有其他问题可以通过我<a href="https://github.com/haloman9527">Github</a>主页的QQ或者邮箱直接询问。</p>]]></content>
      
      
      <categories>
          
          <category> 节点编辑器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity Editor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>节点编辑器(1):特性介绍</title>
      <link href="/graph_processor/1_info/"/>
      <url>/graph_processor/1_info/</url>
      
        <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>本章将会介绍节点编辑器中的特性和其作用，以及使用方式。</p><hr><h1 id="数据结构介绍"><a href="#数据结构介绍" class="headerlink" title="数据结构介绍"></a>数据结构介绍</h1><p>节点编辑器的所有数据都存在<strong>Graph</strong>中，共包含以下三种主要数据。</p><ul><li><strong>Node</strong>，只有<strong>ID</strong>和<strong>Position</strong>两条数据，</li><li><strong>Connection</strong>，包含起始节点和目标节点的<strong>ID</strong>，以及<strong>接口名称</strong>，</li><li><strong>Group</strong>，包含<strong>ID</strong>、<strong>组名</strong>和<strong>节点ID列表</strong>等数据。</li></ul><h2 id="节点的静态数据"><a href="#节点的静态数据" class="headerlink" title="节点的静态数据"></a>节点的静态数据</h2><p>节点的静态数据(默认数据)存储在<code>GraphProcessorUtil</code>中，下方的特性定义的静态数据都存储在此。</p><ul><li>Node Menu Attribute，特性决定了在编辑时节点在节点列表中的位置，并且菜单的最后一项会作为节点的默认名称。</li><li>Node Title Attribute，该特性用于替换默认标题，当然也可以通过<code>BaseNodeVM.Title</code>字段修改标题。</li><li>Node Title Color Attribute，该特性用于替换默认标题背景色，也可以通过<code>BaseeNodeVM.TitleColor</code>字段修改。</li><li>Node Tooltip Attribute，该特性用于给节点View增加悬停提示，可以通过<code>BaseNodeVM.Tooltip</code>字段修改提示文字。</li></ul><p>下面是使用方法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">NodeMenu(<span class="string">&quot;Custom/MyNode&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitle(<span class="string">&quot;我的节点&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitleColor(1f, 0, 0)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNode</span> : <span class="title">BaseNode</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="VM与M的映射关系"><a href="#VM与M的映射关系" class="headerlink" title="VM与M的映射关系"></a>VM与M的映射关系</h1><p>想要使用一个Graph对象，必须要有一个符合条件的VM对象来控制，默认的<code>BaseGraph</code>对应<code>BaseGraphVM</code>，VM基类没有其他功能，需要通过继承实现更多功能。   </p><h2 id="如何添加映射？"><a href="#如何添加映射？" class="headerlink" title="如何添加映射？"></a>如何添加映射？</h2><p>使用<code>ViewModelAttribute</code>，该特性的使用方式是挂在VM类上，作用是将VM类和Model类一一对应起来，映射数据存储在<code>ViewModelFactory</code>中，可通过<code>ViewModelFactory.GetViewModelType(modelType)</code>来获取Model类对应的VM类，<code>ViewModelFactory</code>是一个通用类，属于<code>GraphProcessor</code>依赖的一部分。</p><p>下面是一个简单的自定义节点，通过<code>ViewModel</code>特性，把VM类和Model类做了映射。如果没有对应的VM类，会自动创建默认的BaseNodeVM对象。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">NodeMenu(<span class="string">&quot;Custom/MyNode&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitle(<span class="string">&quot;我的节点&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">NodeTitleColor(1f, 0, 0)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNode</span> : <span class="title">BaseNode</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">ViewModel(typeof(MyNode))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyNodeVM</span> : <span class="title">BaseNodeVM</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyNodeVM</span>(<span class="params">MyNode model</span>) : <span class="title">base</span>(<span class="params">model</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>GraphProcessor基础运用所需要的特性不多，主要是M和VM的映射，本章到此结束，下期将会用节点编辑器做一个简单的计算器出来。如果有其他问题可以通过我<a href="https://github.com/haloman9527">Github</a>主页的QQ或者邮箱直接询问。</p>]]></content>
      
      
      <categories>
          
          <category> 节点编辑器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity Editor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>节点编辑器(0):GraphProcessor介绍</title>
      <link href="/graph_processor/0_info/"/>
      <url>/graph_processor/0_info/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a><strong>前言</strong></h1><p>距离上次写博客已经过了很长一段时间，一是文笔太差，很多时候想写的东西没办法很好的表述出来；二是进步缓慢可以写的东西也不多。这段时间重新把博客重新捣鼓了下，改成用 hexo&amp;github 的方式去搭建了，然后也正好换了新域名，新年新气象，于是重新拾起来写一下，锻炼一下自己的写作能力。</p><p>这篇博客写的仍然是节点编辑器，节点编辑器又经过几个月的迭代，修复了很多bug，也优化了结构，很多地方有大改，之前的文章没有参考价值了，所以重新写下，节点编辑器是我完成度最高的一个项目，使用MVVM架构，逻辑和数据完全分离，没有任何其它多余的功能，正因如此，它的扩展性很强。这个项目我是基于<a href="https://github.com/alelievr">alelievr</a>大佬的<a href="https://github.com/alelievr/NodeGraphProcessor">GraphProcessor</a>修改而来，经过这么长时间的迭代，不能说和原项目有一点相似，只能说是毫不相像了，在设计上已经脱离原项目。</p><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><strong>介绍</strong></h1><blockquote><p>Unity：2019.4<br>依赖：<a href="https://assetstore.unity.com/packages/tools/utilities/odin-inspector-and-serializer-89041">Odin Inspector(请自行购买)</a><br>项目地址：<a href="https://github.com/haloman9527/3.0_GraphProcessor">https://github.com/haloman9527/3.0_GraphProcessor</a>    </p></blockquote><h2 id="数据-Model"><a href="#数据-Model" class="headerlink" title="数据 Model"></a>数据 Model</h2><p>Model用来存储数据，也应该只用来存储数据，并且数据都是公开透明的，至于为什么下面会说，除此之外不应该具有其它功能。</p><p><code>BaseGraph</code>，<code>BaseNode</code>，<code>BaseConnection</code>分别存储图，节点和连线的数据，并且可以继承自定义数据结构。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomGraph</span> : <span class="title">BaseGraph</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> xxx xxx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomNode</span> : <span class="title">BaseNode</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> xxx xxx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomConnection</span> : <span class="title">BaseConnection</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> xxx xxx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="逻辑-View-Model"><a href="#逻辑-View-Model" class="headerlink" title="逻辑 View Model"></a>逻辑 View Model</h2><p>View Model包含所有的逻辑(包括对Graph的操作)，以及非持久化存储数据(例如运行时生成的临时数据)，并且持有Model的引用，所有对Model的操作都应该通过View Model处理，在View Model中对数据的访问进行限制，这也是为什么要把Model中的数据都设置成公开透明的。</p><p><code>BaseGraphVM</code>包含所有操作Graph的逻辑，添加节点、移除节点、连线、断开等，同时可以继承自定义逻辑。<br><code>BaseNodeVM</code>包含节点内部的操作，比如添加端口，移除端口，获取端口连线等。</p><p>创建的VM类需要打上<code>[ViewModel(typeof(xxx))]</code>来绑定Model类，需要注意的是，继承的VM类必须实现父类的构造函数，这样在构建ViewModel的时候，就会自动根据Model类型创建View Model对象，实现自动化处理。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ViewModel(typeof(CustomGraph))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomGraphVM</span> : <span class="title">BaseGraphVM</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">xxx</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">ViewModel(typeof(CustomNode))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomNodeVM</span> : <span class="title">BaseNodeVM</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">xxx</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="视图-View"><a href="#视图-View" class="headerlink" title="视图 View"></a>视图 View</h2><p>View用于展示View Model的数据，注意是View Model，不是Model，上文有说，所有对Model的操作都应该通过View Model进行，所以在View里只能持有View Model的引用，通过View Model中的逻辑操作Model，同时发出通知告知View，View收到通知更新显示。</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://haloman.oss-cn-beijing.aliyuncs.com/hexo-blog-source/graph_processor_cover.png"></p><h1 id="尾声"><a href="#尾声" class="headerlink" title="尾声"></a>尾声</h1><p>关于介绍，到这里就完了，没什么可写的，主要介绍一下基本功能，关于使用，下一篇会详细介绍，从导入到创建一个案例，完成一个功能。</p>]]></content>
      
      
      <categories>
          
          <category> 节点编辑器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity Editor </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
